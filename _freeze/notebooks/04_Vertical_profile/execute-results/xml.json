{
  "hash": "a2a70f79d963c3fe6d1834b3041860af",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Vertical profile of WEP\nauthor: Alex Koiter\n---\n\n\n\n\n## Load Libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: viridisLite\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(patchwork)\n```\n:::\n\n\n\n\n## Read in data\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nconc <- read_csv(here::here(\"notebooks/Data/P_concentration.csv\")) %>%\n  rename(\"conc\" = \"ak_content\") %>%\n  filter(timing == \"Before\") %>%\n  mutate(sample_type = fct_recode(sample_type, \"Ah\" = \"Soil\")) %>%\n  mutate(sample_type = fct_relevel(sample_type, c(\"Ah\", \"Organic\", \"Litter\",\"Biomass\"))) %>%\n  mutate(location = fct_relevel(location, c(\"Upper\", \"Middle\", \"Lower\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 1141 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): sample_type, timing, plot, location, treatment\ndbl (3): site, ak_content, year\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nmass_data <- read_csv(here::here(\"notebooks/Data/mass.csv\")) %>%\n  filter(timing == \"Before\") %>%\n  mutate(sample_type = fct_relevel(sample_type, c(\"Biomass\", \"Litter\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 576 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): sample_type, timing, plot, location, treatment\ndbl (3): site, dryweight, year\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nbd_data <- read_csv(here::here(\"notebooks/Data/bulk density.csv\")) %>% # Bulk density measurements\n  mutate(mass = bd * length_cm/100 * 1) %>%\n  mutate(sample_type = fct_recode(sample_type, \"Organic\" = \"LFH\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 96 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): plot, location, sample_type, treatment\ndbl (3): site, length_cm, bd\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\n\n## Merge data\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ntotal_data <- conc %>%\n  left_join(mass_data) %>%\n  left_join(bd_data) %>%\n  mutate(p_total = case_when(sample_type == \"Biomass\" ~ conc * dryweight/1000 /0.25,\n                             sample_type == \"Litter\" ~ conc * dryweight/1000 /0.25,\n                             sample_type == \"Organic\" ~ conc *mass,\n                             sample_type == \"Ah\"  ~ conc *mass)) %>%\n  mutate(sample_type = fct_relevel(sample_type, c(\"Ah\", \"Organic\", \"Litter\",\"Biomass\"))) %>%\n  mutate(location = fct_relevel(location, c(\"Upper\", \"Middle\", \"Lower\")))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(sample_type, site, timing, plot, location, year,\ntreatment)`\nJoining with `by = join_by(sample_type, site, plot, location, treatment)`\n```\n\n\n:::\n:::\n\n\n\n\n## Summary\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nconc %>%\n  group_by(sample_type) %>%\n  summarise(mean = mean(conc, na.rm = T),\n            median = median(conc, na.rm = T),\n            sd = sd(conc, na.rm = T),\n            IQR = quantile(conc, 0.75, na.rm = T) -quantile(conc, 0.25, na.rm = T))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  sample_type  mean median     sd    IQR\n  <fct>       <dbl>  <dbl>  <dbl>  <dbl>\n1 Ah           1.12  0.953  0.651  0.785\n2 Organic      3.99  3.40   2.54   2.38 \n3 Litter      39.7  39.0   23.2   32.9  \n4 Biomass     91.7  82.8   46.4   54.3  \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nconc %>%\n  group_by(sample_type, location) %>%\n  summarise(mean = mean(conc, na.rm = T),\n            median = median(conc, na.rm = T),\n            sd = sd(conc, na.rm = T),\n            IQR = quantile(conc, 0.75, na.rm = T) -quantile(conc, 0.25, na.rm = T))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`summarise()` has grouped output by 'sample_type'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 × 6\n# Groups:   sample_type [4]\n   sample_type location    mean median     sd    IQR\n   <fct>       <fct>      <dbl>  <dbl>  <dbl>  <dbl>\n 1 Ah          Upper      1.38   1.24   0.803  0.901\n 2 Ah          Middle     1.13   1.02   0.499  0.704\n 3 Ah          Lower      0.864  0.726  0.507  0.387\n 4 Organic     Upper      4.35   4.03   2.49   2.40 \n 5 Organic     Middle     4.32   3.53   2.98   2.27 \n 6 Organic     Lower      3.29   2.93   1.97   2.03 \n 7 Litter      Upper     29.5   29.7   15.7   22.0  \n 8 Litter      Middle    40.5   38.8   23.2   34.0  \n 9 Litter      Lower     48.7   49.2   25.8   31.6  \n10 Biomass     Upper     86.1   82.9   40.6   56.3  \n11 Biomass     Middle    88.5   82.7   47.8   49.6  \n12 Biomass     Lower    100.    82.6   49.8   63.6  \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntotal_data %>%\n  group_by(sample_type) %>%\n  summarise(mean = mean(p_total, na.rm = T),\n            median = median(p_total, na.rm = T),\n            sd = sd(p_total, na.rm = T),\n            IQR = quantile(p_total, 0.75, na.rm = T) -quantile(p_total, 0.25, na.rm = T))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  sample_type  mean median    sd   IQR\n  <fct>       <dbl>  <dbl> <dbl> <dbl>\n1 Ah           49.5   42.5  29.5  32.0\n2 Organic      19.9   17.7  13.7  15.6\n3 Litter       15.7   11.1  14.3  14.3\n4 Biomass      31.9   26.3  23.5  23.3\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ntotal_data %>%\n  group_by(sample_type, location) %>%\n  summarise(mean = mean(p_total, na.rm = T),\n            median = median(p_total, na.rm = T),\n            sd = sd(p_total, na.rm = T),\n            IQR = quantile(p_total, 0.75, na.rm = T) -quantile(p_total, 0.25, na.rm = T))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`summarise()` has grouped output by 'sample_type'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 12 × 6\n# Groups:   sample_type [4]\n   sample_type location  mean median    sd   IQR\n   <fct>       <fct>    <dbl>  <dbl> <dbl> <dbl>\n 1 Ah          Upper    64.5   57.7  35.8  41.5 \n 2 Ah          Middle   49.0   44.6  21.5  26.0 \n 3 Ah          Lower    35.1   28.9  21.4  18.3 \n 4 Organic     Upper    23.1   22.1  13.1  17.1 \n 5 Organic     Middle   19.2   17.8  12.6  10.4 \n 6 Organic     Lower    17.4   12.8  14.8  11.8 \n 7 Litter      Upper     8.75   6.66  7.50  8.25\n 8 Litter      Middle   14.4    9.29 12.2  13.4 \n 9 Litter      Lower    23.7   17.4  17.1  21.1 \n10 Biomass     Upper    22.7   18.6  14.9  14.6 \n11 Biomass     Middle   26.6   18.6  18.9  18.3 \n12 Biomass     Lower    46.0   34.3  27.7  28.1 \n```\n\n\n:::\n:::\n\n\n\n\n\n## Plots\nBulk Density\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\np5 <- ggplot(data = bd_data, aes(y = sample_type, x = bd, fill = location)) + \n  geom_boxplot() +\n  theme_bw(base_size = 12) +\n  labs(x = expression(paste(\"Bulk Density (\", kg~m^{-3}, \")\")), tag = \"b)\") +\n  scale_fill_viridis_d(begin = 0.3, end = 1) +\n  theme(legend.position = \"bottom\", \n        legend.title = element_blank(),\n        axis.title.y = element_blank())\n```\n:::\n\n\n\n\nbiomass and litter weights\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\np4 <- ggplot(data = mass_data, aes(y = sample_type, x = dryweight/1000 /0.25, fill = location)) + \n  geom_boxplot() +\n  theme_bw(base_size = 12) +\n  labs(x = expression(paste(\"Mass (\", kg~m^{-2}, \")\")), y = \"P Source\", tag = \"a)\") +\n  scale_fill_viridis_d(begin = 0.3, end = 1) +\n  theme(legend.position = \"bottom\", \n        legend.title = element_blank())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: supp-weights-bd\n#| fig-cap: \"a) Mass of biomass and litter before grazing and mowing and b) the bulk density of the organic layer and 10 cm Ah horizon\"\n#| fig-alt: \"a) Mass of biomass and litter before grazing and mowing and b) the bulk density of the organic layer and 10 cm Ah horizon\"\n#|\np4 + p5 + plot_layout(guides = 'collect') & theme(legend.position = 'bottom', legend.title = element_blank())\n```\n\n::: {.cell-output-display}\n![a) Mass of biomass and litter before grazing and mowing and b) the bulk density of the organic layer and 10 cm Ah horizon](04_Vertical_profile_files/figure-jats/supp-weights-bd-1.png){fig-alt='a) Mass of biomass and litter before grazing and mowing and b) the bulk density of the organic layer and 10 cm Ah horizon'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\np1 <- ggplot(data = conc, aes(y = sample_type, x = conc, fill = location)) + \n  geom_boxplot() + \n  #scale_x_log10() +\n  theme_bw(base_size = 12) +\n  theme(legend.position = c(0.2, 0.8),\n        legend.title = element_blank()) +\n  labs(x = expression(paste(\"WEP Concentration (\", mg~kg^{-1}, \")\")), y = \"P Source\", tag = \"a)\") +\n  scale_fill_viridis_d(name = \"Location\", begin = 0.3, end = 1)\np1\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 2 rows containing non-finite values (`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](04_Vertical_profile_files/figure-jats/unnamed-chunk-8-1.png)\n:::\n\n```{.r .cell-code .hidden}\np2 <- ggplot(data = total_data, aes(y = sample_type, x = p_total, fill = location)) + \n  geom_boxplot() + \n  #scale_x_log10() +\n  theme_bw(base_size = 12) +\n  theme(axis.title.y = element_blank(),\n        legend.position = \"none\") +\n  labs(x = expression(paste(\"WEP Total (\", mg~m^{-2}, \")\")), tag = \"b)\") +\n  scale_fill_viridis_d(name = \"Location\", begin = 0.3, end = 1)\np2\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 2 rows containing non-finite values (`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](04_Vertical_profile_files/figure-jats/unnamed-chunk-8-2.png)\n:::\n:::\n\n::: {#cell-fig-vertical-WEP .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-vertical-WEP\n#| fig-cap: \"Vertical and longitudinal profiles of a) WEP concentration and b) WEP content in the riparian areas prior to grazing and mowing treatments.\"\n#| fig-alt: \"Vertical and longitudinal profiles of a) WEP concentration and b) WEP content in the riparian areas prior to grazing and mowing treatments.\"\n#|\np3 <- p1+p2 + plot_layout(guides = 'collect') & theme(legend.position = 'bottom', legend.title = element_blank())  \n\np3\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 2 rows containing non-finite values (`stat_boxplot()`).\nRemoved 2 rows containing non-finite values (`stat_boxplot()`).\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: fig-vertical-WEP\n#| fig-cap: \"Vertical and longitudinal profiles of a) WEP concentration and b) WEP content in the riparian areas prior to grazing and mowing treatments.\"\n#| fig-alt: \"Vertical and longitudinal profiles of a) WEP concentration and b) WEP content in the riparian areas prior to grazing and mowing treatments.\"\n#|\n#ggsave(plot = p3, filename = \"Figures/Profile P.png\", width = 174, height = 100, units = \"mm\", dpi = 600) \n```\n\n::: {.cell-output-display}\n![Vertical and longitudinal profiles of a) WEP concentration and b) WEP content in the riparian areas prior to grazing and mowing treatments.](04_Vertical_profile_files/figure-jats/fig-vertical-WEP-1.png){#fig-vertical-WEP fig-alt='Vertical and longitudinal profiles of a) WEP concentration and b) WEP content in the riparian areas prior to grazing and mowing treatments.'}\n:::\n:::",
    "supporting": [
      "04_Vertical_profile_files/figure-jats"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}