{
  "hash": "424794ba8fc2addba3a8d2d972b8ee86",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Riparian organic and mineral soil WEP in response to grazing\nauthor: Alex Koiter\n---\n\n\n\n\n## Load Libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(glmmTMB)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in checkDepPackageVersion(dep_pkg = \"TMB\"): Package version inconsistency detected.\nglmmTMB was built with TMB version 1.9.6\nCurrent TMB version is 1.9.9\nPlease re-install glmmTMB from source or restore original 'TMB' package (see '?reinstalling' for more information)\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(DHARMa)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThis is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(emmeans)\n```\n:::\n\n\n\n\n## Read in clean data \n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nconc <- read_csv(here::here(\"notebooks/Data/P_concentration.csv\")) %>%\n  rename(\"conc\" = \"ak_content\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 1141 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): sample_type, timing, plot, location, treatment\ndbl (3): site, ak_content, year\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\n\n## Organics data\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\norganic_diff <- conc %>%\n  filter(sample_type == \"Organic\") %>%\n  pivot_wider(names_from = timing, values_from = conc) %>%\n  mutate(diff = Before - After) %>%\n  mutate(treatment = fct_recode(treatment, \"Graze\" = \"Regular Graze\")) %>%\n  mutate(treatment = fct_relevel(treatment, c(\"Control\", \"Graze\", \"High Graze\", \"Mow\"))) %>%\n  mutate(location = fct_relevel(location, c(\"Upper\", \"Middle\", \"Lower\")))\n```\n:::\n\n\n\n\n## Soil data\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nsoil_diff <- conc %>%\n  filter(sample_type == \"Soil\") %>%\n  pivot_wider(names_from = timing, values_from = conc) %>%\n  mutate(diff = Before - After) %>%\n  mutate(treatment = fct_recode(treatment, \"Graze\" = \"Regular Graze\")) %>%\n  mutate(treatment = fct_relevel(treatment, c(\"Control\", \"Graze\", \"High Graze\", \"Mow\"))) %>%\n  mutate(location = fct_relevel(location, c(\"Upper\", \"Middle\", \"Lower\")))\n```\n:::\n\n\n\n\n\n## Organics analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nm7 <- glmmTMB(diff ~ treatment * location + (1|site) + (1|year),\n              data = organic_diff)\nsimulateResiduals(m7, n = 1000, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](03_Soils_analysis_files/figure-jats/unnamed-chunk-5-1.png)\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.238 0.027 0.226 0.24 0.719 0.392 0.179 0.09 0.368 0.246 0.39 0.748 0.864 0.689 0.362 0.796 0.846 0.507 0.995 0.711 ...\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncar::Anova(m7, type = \"III\")  # No interaction\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: diff\n                    Chisq Df Pr(>Chisq)\n(Intercept)        0.0818  1     0.7748\ntreatment          3.4925  3     0.3217\nlocation           0.4320  2     0.8057\ntreatment:location 2.8110  6     0.8322\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nm7 <- glmmTMB(diff ~ treatment + location + (1|site) + (1|year),\n              data = organic_diff)\nsimulateResiduals(m7, n = 1000, plot = TRUE) # No interaction\n```\n\n::: {.cell-output-display}\n![](03_Soils_analysis_files/figure-jats/unnamed-chunk-6-1.png)\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.246 0.033 0.186 0.226 0.693 0.435 0.183 0.12 0.31 0.257 0.319 0.8 0.865 0.745 0.32 0.802 0.881 0.428 0.995 0.63 ...\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nperformance::check_collinearity(m7)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Check for Multicollinearity\n\nLow Correlation\n\n      Term  VIF      VIF  CI Increased SE Tolerance\n treatment 1.00 [1.00, 1.00]         1.00      1.00\n  location 1.00 [1.00, 1.00]         1.00      1.00\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncar::Anova(m7, type = \"III\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: diff\n             Chisq Df Pr(>Chisq)  \n(Intercept) 0.9723  1    0.32411  \ntreatment   8.2398  3    0.04131 *\nlocation    0.5743  2    0.75039  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\nPost-hoc\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nm_emms7 <- emmeans(m7, ~treatment)\npairs(m_emms7, adjust = \"fdr\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast             estimate    SE  df t.ratio p.value\n Control - Graze        -1.486 0.594 135  -2.501  0.0656\n Control - High Graze   -0.625 0.594 135  -1.052  0.3534\n Control - Mow          -1.378 0.594 135  -2.319  0.0656\n Graze - High Graze      0.861 0.594 135   1.449  0.2994\n Graze - Mow             0.108 0.594 135   0.182  0.8560\n High Graze - Mow       -0.753 0.594 135  -1.267  0.3110\n\nResults are averaged over the levels of: location \nP value adjustment: fdr method for 6 tests \n```\n\n\n:::\n:::\n\n\n\n\n### Plots\nExtra\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndf <- data.frame(x1 = c(-Inf, -Inf), x2 = c(Inf, Inf), y2 = c(Inf, 0), y1 = c(0, -Inf), difference = c(\"Net removal\", \"Net addition\")) %>%\n  mutate(difference = fct_relevel(difference, c(\"Net removal\", \"Net addition\"))) \n```\n:::\n\n\n\nPlots\n\n\n\n::: {#cell-fig-organic-WEP .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-organic-WEP\n#| fig-cap: \"Change in riparian organic layer WEP concentration following grazing or mowing in each of the riparian zones. A significant effect of treatment was detected; however, the post-hoc analysis was not able to detect any significant (p < 0.05) pairwise contrasts.\"\n#| fig-alt: \"Boxplots showing the change in riparian organic layer WEP concentration following grazing or mowing.\"\n#|\np1 <- ggplot(data = organic_diff) +\n  theme_bw(base_size = 12) + \n  geom_hline(yintercept = 0) +\n  geom_rect(data = df, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2, fill = difference), alpha = 0.15, colour = \"black\") +\n  scale_fill_manual(values = c(\"white\", \"black\")) +\n  ggnewscale::new_scale_fill() +\n  geom_boxplot(aes(x = treatment, y = diff, fill = location)) +\n  scale_fill_viridis_d(name = \"Location\", begin = 0.3, end = 1) +\n  labs(y = expression(paste(\"Net WEP Difference (\", mg~kg^{-1}, \")\")), x = \"Treatment\") +\n  theme(axis.title.x = element_blank(),\n        axis.text.x = element_text(angle = 0, vjust = 1, hjust = 0.5),\n        legend.position = 'bottom', legend.title = element_blank())\np1\n#ggsave(plot = p1, filename = \"Figures/Organics_WEP.png\", width = 150, height = 100, units = \"mm\", dpi = 600)\n```\n\n::: {.cell-output-display}\n![Change in riparian organic layer WEP concentration following grazing or mowing in each of the riparian zones. A significant effect of treatment was detected; however, the post-hoc analysis was not able to detect any significant (p < 0.05) pairwise contrasts.](03_Soils_analysis_files/figure-jats/fig-organic-WEP-1.png){#fig-organic-WEP fig-alt='Boxplots showing the change in riparian organic layer WEP concentration following grazing or mowing.'}\n:::\n:::\n\n\n\n\n## Mineral soil analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nm8 <- glmmTMB(diff ~ treatment * location + (1|site) + (1|year),\n              data = soil_diff)\nsimulateResiduals(m8, n = 1000, plot = TRUE) \n```\n\n::: {.cell-output-display}\n![](03_Soils_analysis_files/figure-jats/unnamed-chunk-10-1.png)\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.041 0.077 0.008 0.313 0.396 0.023 0.231 0.106 0.047 0.023 0.015 0 0.083 0.149 0.197 0.225 0.155 0.19 0.274 0.108 ...\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncar::Anova(m8, type = \"III\") # No interaction\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: diff\n                    Chisq Df Pr(>Chisq)\n(Intercept)        0.7086  1     0.3999\ntreatment          1.8322  3     0.6080\nlocation           1.0737  2     0.5846\ntreatment:location 4.3582  6     0.6283\n```\n\n\n:::\n:::\n\n\n\n\nNo interaction\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nm8 <- glmmTMB(diff ~ treatment + location + (1|site) + (1|year),\n              data = soil_diff)\nsimulateResiduals(m8, n = 1000, plot = TRUE) \n```\n\n::: {.cell-output-display}\n![](03_Soils_analysis_files/figure-jats/unnamed-chunk-11-1.png)\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.021 0.097 0.01 0.402 0.365 0.018 0.208 0.101 0.057 0.027 0.015 0 0.081 0.179 0.276 0.202 0.115 0.134 0.315 0.129 ...\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nperformance::check_collinearity(m8)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Check for Multicollinearity\n\nLow Correlation\n\n      Term  VIF      VIF  CI Increased SE Tolerance\n treatment 1.00 [1.00, 1.00]         1.00      1.00\n  location 1.00 [1.00, 1.00]         1.00      1.00\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncar::Anova(m8, type = \"III\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: diff\n             Chisq Df Pr(>Chisq)\n(Intercept) 0.2055  1     0.6503\ntreatment   2.5923  3     0.4588\nlocation    1.1674  2     0.5578\n```\n\n\n:::\n:::\n\n\n\n\n### plots\n\n\n\n::: {#cell-fig-soil-WEP .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-soil-WEP\n#| fig-cap: \"Change in riparian Ah layer (0-10cm) WEP concentration following grazing or mowing in each of the riparian zones. No significant effect of treatment or zone was detected.\"\n#| fig-alt: \"Boxplots showing the change in riparian  Ah layer (0-10cm) WEP concentration following grazing or mowing.\"\n#|\np2 <- ggplot(data = soil_diff) +\n  theme_bw(base_size = 12) + \n  geom_hline(yintercept = 0) +\n  geom_rect(data = df, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2, fill = difference), alpha = 0.15, colour = \"black\") +\n  scale_fill_manual(values = c(\"white\", \"black\")) +\n  ggnewscale::new_scale_fill() +\n  geom_boxplot(aes(x = treatment, y = diff, fill = location)) +\n  scale_fill_viridis_d(name = \"Location\", begin = 0.3, end = 1) +\n  labs(y = expression(paste(\"Net WEP Difference (\", mg~kg^{-1}, \")\")), x = \"Treatment\") +\n  theme(axis.title.x = element_blank(),\n        axis.text.x = element_text(angle = 0, vjust = 1, hjust = 0.5),\n        legend.position = 'bottom', legend.title = element_blank())\np2\n#ggsave(plot = p2, filename = \"Figures/Soil_WEP.png\", width = 150, height = 100, units = \"mm\", dpi = 600)\n```\n\n::: {.cell-output-display}\n![Change in riparian Ah layer (0-10cm) WEP concentration following grazing or mowing in each of the riparian zones. No significant effect of treatment or zone was detected.](03_Soils_analysis_files/figure-jats/fig-soil-WEP-1.png){#fig-soil-WEP fig-alt='Boxplots showing the change in riparian  Ah layer (0-10cm) WEP concentration following grazing or mowing.'}\n:::\n:::\n",
    "supporting": [
      "03_Soils_analysis_files/figure-jats"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}