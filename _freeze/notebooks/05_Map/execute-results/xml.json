{
  "hash": "c08ed28148fa9ef9ac3df9de29802339",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Map of study area\nauthor: Alex Koiter\n---\n\n\n\n\n\n\n\n\n\n## Load Libraries\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(ggspatial)\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLinking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(rnaturalearth)\nlibrary(patchwork)\nlibrary(OpenStreetMap)\n```\n:::\n\n\n\n\n\n\n\n\n\n\n## Important coordinants \nRegional site location\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nsite <- st_sfc(st_point(c(-99.924176, 50.056015)), crs = 4326)\nbox = c(xmin = -99.99, xmax = -99.924176 + 0.12, ymax = 50.056015 +.065, ymin = 50.056015 - 0.065)\n```\n:::\n\n\n\n\n\n\n\n\n\n\nStudy plot locations\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# sites <- st_as_sf(data.frame(site = c(1,2,3,4), lat = c(50.052525, 50.052209, 50.059208, 50.060235), long = c(-99.924242, -99.918429, -99.912849, -99.931591)), coords = c(\"long\", \"lat\"), crs = 4362)\n                                                                                              \nsites <- data.frame(site = c(1,2,3,4), lat = c(50.052525, 50.052209, 50.059208, 50.060235), long = c(-99.924242, -99.918429, -99.912849, -99.931591))\n```\n:::\n\n\n\n\n\n\n\n\n\n\n\n## Canada\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncanada <- ne_states(country = \"Canada\", returnclass = \"sf\") %>%\n  st_transform(crs = 3348) \n```\n:::\n\n\n\n\n\n\n\n\n\n\n## Maps\n\n\n### Canada\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\np1 <- ggplot() +\n  theme_bw() +\n  layer_spatial(canada, fill = \"white\") +\n  layer_spatial(site, shape = 23, colour = \"red\", fill = \"red\", size = 2) +\n  theme(axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        axis.title = element_blank(),\n        plot.margin = unit(c(0,0,0,0), \"mm\"),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        #panel.border = element_blank(),\n        panel.background = element_blank())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nsf_use_s2(FALSE)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSpherical geometry (s2) switched off\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nmb_river <- ne_download(scale = 10,  type = 'rivers_lake_centerlines', category = \"physical\", returnclass = \"sf\") %>%\n  st_transform(crs = 4326) %>%\n  st_crop(st_bbox(c(xmin = -101.5889, ymin = 48.99267, \n                    xmax = -95.15399, ymax = 51.399), \n                  crs = st_crs(.)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `ne_10m_rivers_lake_centerlines' from data source \n  `/tmp/Rtmp0akUXl/ne_10m_rivers_lake_centerlines.shp' using driver `ESRI Shapefile'\nSimple feature collection with 1473 features and 38 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: -164.9035 ymin: -52.15775 xmax: 177.5204 ymax: 75.79348\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nalthough coordinates are longitude/latitude, st_intersection assumes that they\nare planar\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nmb_lakes <- ne_download(scale = 10,  type = 'lakes', category = \"physical\", returnclass = \"sf\") %>%\n  st_transform(crs = 4326) %>%\n  st_crop(st_bbox(c(xmin = -101.5889, ymin = 48.99267, \n                    xmax = -95.15399, ymax = 51.399), \n                  crs = st_crs(.)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `ne_10m_lakes' from data source `/tmp/Rtmp0akUXl/ne_10m_lakes.shp' using driver `ESRI Shapefile'\nSimple feature collection with 1355 features and 41 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -165.9656 ymin: -50.66967 xmax: 177.1544 ymax: 81.95521\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nalthough coordinates are longitude/latitude, st_intersection assumes that they\nare planar\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nmb <- ne_states(country = \"Canada\", returnclass = \"sf\") %>%\n  filter(name == \"Manitoba\") %>%\n  st_transform(crs = 4326) %>%\n  st_crop(st_bbox(c(xmin = -101.5889, ymin = 48.99267, \n                    xmax = -95.15399, ymax = 51.399), \n                  crs = st_crs(.)))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nalthough coordinates are longitude/latitude, st_intersection assumes that they\nare planar\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nmb_cities <- maps::canada.cities %>%\n  filter(country.etc == \"MB\") %>%\n  mutate(name = str_remove(name, \" [A-Z]{2}$\")) %>%\n  st_as_sf(coords = c(\"long\", \"lat\"), crs = 4326) %>%\n  st_transform(crs = 4326) %>%\n  st_crop(st_bbox(c(xmin = -101.5889, ymin = 48.99267, \n                    xmax = -95.15399, ymax = 51.399), \n                  crs = st_crs(.))) %>%\n  filter(pop >5000)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nalthough coordinates are longitude/latitude, st_intersection assumes that they\nare planar\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\np4 <- ggplot() +\n  theme_bw() +\n  geom_sf(data = mb, fill = \"white\") +\n  geom_sf(data = mb_river, colour = \"skyblue4\") +\n    geom_sf(data = mb_lakes, fill = \"lightblue\") +\n  geom_sf(data = mb_cities) +\n  ggrepel::geom_label_repel(\n    data = mb_cities,\n    aes(label = name, geometry = geometry),\n    stat = \"sf_coordinates\",\n    min.segment.length = 0,\n    nudge_y = 0.02,\n    size = 2\n  ) +\n  layer_spatial(site, shape = 23, colour = \"red\", fill = \"red\", size = 2) +\n  labs(tag = \"a)\") +\n  annotation_scale(location = \"bl\",\n                   height = unit(0.05, \"cm\"), \n                   pad_y = unit(0.5, \"cm\"),\n                   pad_x = unit(1.1, \"cm\")) +\n  annotation_north_arrow(location = \"br\", \n                         height = unit(0.5, \"cm\"),\n                         width = unit(0.5, \"cm\"), \n                   pad_y = unit(0.5, \"cm\"),\n                   pad_x = unit(1.1, \"cm\")) +\n  theme(axis.text = element_blank(),\n        axis.ticks = element_blank(),\n        axis.title = element_blank(),\n        plot.margin = unit(c(0,0,0,0), \"mm\"),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        panel.border = element_blank(),\n        panel.background = element_blank())\n\n\n\nmap <- openmap(c(50.047, -99.936), c( 50.065, -99.909), zoom = NULL,\n                  type = \"esri-imagery\", mergeTiles = TRUE) \n\nsa_map2 <- openproj(map, projection = \"+proj=longlat +datum=WGS84 +no_defs +type=crs\")\n\nsites <- data.frame(sites = c(\"1\", \"2\", \"3\", \"4\"), lat = c(50.052472, 50.052288, 50.059197, 50.060114), long = c(-99.924327, -99.918839, -99.912919, -99.931479)) \n\n\np5 <- OpenStreetMap::autoplot.OpenStreetMap(sa_map2) +\n  theme_void() +\n  geom_point(data = sites,\n           aes(x = long , y = lat ), \n           colour = \"red\", size =  2.5) +\n  ggrepel::geom_label_repel(data = sites, \n            aes(long, lat, label = sites), \n            size = 3, colour = \"black\",\n            min.segment.length = 0) + \n  geom_segment(aes(x = -99.934824, y = 50.048, xend = -99.927655, yend = 50.048), colour = \"black\", linewidth = 1) +\n  geom_segment(aes(x = -99.931150, y = 50.048, xend = -99.927655, yend = 50.048), colour = \"white\", linewidth = 1) +\n  annotate(\"label\", x = -99.926, y = 50.048, label = \"500m\", fill = \"lightgray\") +\n  labs(tag = \"b)\")\n```\n:::\n\n::: {#cell-fig-mapr .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-mapr\n#| fig-cap: \"Showing a) the location of the study site in southern Manitoba with an inset map of Canada; and b) the locations of the four riparian areas included in this study\"\n#| fig-alt: \"Map of Southern Manitba with an inset map of Canada with red dot showing location of site. Satellite imagery of the locations of the four riparian areas included in this study\"\n\np6 <- p4 + inset_element(p1, left = 0.6, bottom = 0.6, right = 1, top = 1) + p5\np6\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not\ngive correct results for longitude/latitude data\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: fig-mapr\n#| fig-cap: \"Showing a) the location of the study site in southern Manitoba with an inset map of Canada; and b) the locations of the four riparian areas included in this study\"\n#| fig-alt: \"Map of Southern Manitba with an inset map of Canada with red dot showing location of site. Satellite imagery of the locations of the four riparian areas included in this study\"\n\n#ggsave(plot = p6, filename = here::here(\"./Figures/Figure 1.tiff\"), width = 174, height = 100, units = \"mm\", dpi = 400) \n```\n\n::: {.cell-output-display}\n![Showing a) the location of the study site in southern Manitoba with an inset map of Canada; and b) the locations of the four riparian areas included in this study](05_Map_files/figure-jats/fig-mapr-1.png){#fig-mapr fig-alt='Map of Southern Manitba with an inset map of Canada with red dot showing location of site. Satellite imagery of the locations of the four riparian areas included in this study'}\n:::\n:::\n",
    "supporting": [
      "05_Map_files/figure-jats"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}