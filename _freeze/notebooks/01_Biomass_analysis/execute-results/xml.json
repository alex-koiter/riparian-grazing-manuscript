{
  "hash": "730a5ee0268272d9e339714a4392d0b0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Riparian vegetation WEP in response to grazing\nauthor: Alex Koiter\nhtml-table-processing: none\n---\n\n\n\n\n\n\n\n\n\n\n## Load Libraries\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(glmmTMB)\nlibrary(DHARMa)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThis is DHARMa 0.4.7. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(emmeans)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWelcome to emmeans.\nCaution: You lose important information if you filter this package's results.\nSee '? untidy'\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: viridisLite\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(patchwork)\nlibrary(gt)\n```\n:::\n\n\n\n\n\n\n\n\n\n\n## Read in data\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nconc <- read_csv(here::here(\"./notebooks/P_concentration.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 1141 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): sample_type, timing, plot, location, treatment\ndbl (3): site, ak_content, year\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nmass_data <- read_csv(here::here(\"./notebooks/mass.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 576 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): sample_type, timing, plot, location, treatment\ndbl (3): site, dryweight, year\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n## Merge data\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nveg_data <- mass_data %>%\n  right_join(conc) %>%\n  rename(conc = ak_content) %>% # mg/kg\n  mutate(p_total = conc * dryweight/1000 /0.25) # mg/m2\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(sample_type, site, timing, plot, location, year,\ntreatment)`\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n## Biomass data\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nbiomass_diff <- veg_data %>%\n  filter(sample_type == \"Biomass\") %>%\n  mutate(dryweight = dryweight/1000 /0.25) %>% # kg/m2\n  pivot_longer(cols = c(dryweight, p_total, conc), names_to = \"measure\", values_to = \"value\") %>%\n  pivot_wider(names_from = timing, values_from = value) %>%\n  mutate(diff = Before - After)\n```\n:::\n\n\n\n\n\n\n\n\n\n\n\n## Biomass Analysis\n### P-total\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nm <- glmmTMB((diff) ~ treatment * location + Before + (1|site) + (1|year),\n             data = filter(biomass_diff, measure == \"p_total\"))\nsimulateResiduals(m, n = 1000, plot = TRUE) \n```\n\n::: {.cell-output-display}\n![](01_Biomass_analysis_files/figure-jats/unnamed-chunk-5-1.png)\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.751 0.611 0.716 0.648 0.463 0.707 0.684 0.558 0.811 0.623 0.328 0.664 0.676 0.595 0.785 0.304 0.68 0.547 0.369 0.329 ...\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncar::Anova(m, type = \"III\") # No interaction\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: (diff)\n                      Chisq Df Pr(>Chisq)    \n(Intercept)         22.1909  1  2.468e-06 ***\ntreatment           15.4435  3   0.001474 ** \nlocation             9.0047  2   0.011083 *  \nBefore             178.7862  1  < 2.2e-16 ***\ntreatment:location   6.3738  6   0.382650    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\nRemoving interaction\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ntemp <- filter(biomass_diff, measure == \"p_total\") ## otherwise issue with emmeans()\nm <- glmmTMB((diff) ~ treatment + location + Before + (1|site) + (1|year),\n             data = temp)\nsimulateResiduals(m, n = 1000, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](01_Biomass_analysis_files/figure-jats/unnamed-chunk-6-1.png)\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.781 0.692 0.617 0.69 0.469 0.664 0.714 0.47 0.829 0.472 0.332 0.78 0.71 0.511 0.803 0.336 0.739 0.442 0.245 0.323 ...\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nperformance::check_collinearity(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Check for Multicollinearity\n\nLow Correlation\n\n      Term  VIF       VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n treatment 1.00 [1.00, 2.67e+11]         1.00      1.00     [0.00, 1.00]\n  location 1.59 [1.33,     2.03]         1.26      0.63     [0.49, 0.75]\n    Before 1.59 [1.34,     2.04]         1.26      0.63     [0.49, 0.75]\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncar::Anova(m, type = \"III\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: (diff)\n              Chisq Df Pr(>Chisq)    \n(Intercept)  24.370  1  7.949e-07 ***\ntreatment    24.771  3  1.724e-05 ***\nlocation     15.741  2  0.0003818 ***\nBefore      176.833  1  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\nPost-hoc\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nm_emms1 <- emmeans(m, ~treatment)\nm_emms2 <- emmeans(m, ~location)\n\ntreat_pair <- summary(pairs(m_emms1, adjust = \"fdr\")) %>%\n  mutate(type = \"Treatment\")\nlocation_pair <- summary(pairs(m_emms2, adjust = \"fdr\")) %>%\n  mutate(type = \"Location\")\n\npairs <- treat_pair %>%\n  bind_rows(location_pair) %>%\n  rename(\"Contrast\" = \"contrast\", \"Estimate\" = \"estimate\", \"t ratio\" = \"t.ratio\", \"p value\" = \"p.value\")\n```\n:::\n\n::: {#tbl-biomass-posthoc .cell tbl-cap='Results of the post-hoc pairwise comparisons with a Benjamini-Hochberg p value adjustment for differences in the net biomass WEP ($mg~m^{-2}$) between the four treatments and three riparian sampling locations.'}\n\n```{.r .cell-code .hidden}\n#| label: tbl-biomass-posthoc\n#| tbl-cap: Results of the post-hoc pairwise comparisons with a Benjamini-Hochberg p value adjustment for differences in the net biomass WEP ($mg~m^{-2}$) between the four treatments and three riparian sampling locations.\n\npairs |>\n  mutate(Contrast = fct_recode(Contrast, \"Control - Graze\" = \"Control - Regular Graze\", \"High Graze - Graze\" = \"High Graze - Regular Graze\", \"Mow - Graze\" = \"Mow - Regular Graze\")) |>\n  group_by(type) |>\n  gt() |>\n  fmt_number(columns = c(\"Estimate\", \"SE\", \"t ratio\"), decimal = 2)|>\n  fmt_number(columns = c(\"p value\"), decimal = 3)|>\n  sub_small_vals(threshold = 0.001) |>\n  tab_style(style =  cell_text(weight = \"bold\", align = \"center\"), locations =  cells_row_groups()) |>\n  tab_options(column_labels.font.weight = \"bold\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"yiwzuonmhu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#yiwzuonmhu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#yiwzuonmhu thead, #yiwzuonmhu tbody, #yiwzuonmhu tfoot, #yiwzuonmhu tr, #yiwzuonmhu td, #yiwzuonmhu th {\n  border-style: none;\n}\n\n#yiwzuonmhu p {\n  margin: 0;\n  padding: 0;\n}\n\n#yiwzuonmhu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#yiwzuonmhu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#yiwzuonmhu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#yiwzuonmhu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#yiwzuonmhu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#yiwzuonmhu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#yiwzuonmhu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#yiwzuonmhu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#yiwzuonmhu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#yiwzuonmhu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#yiwzuonmhu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#yiwzuonmhu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#yiwzuonmhu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#yiwzuonmhu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#yiwzuonmhu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yiwzuonmhu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#yiwzuonmhu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#yiwzuonmhu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#yiwzuonmhu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yiwzuonmhu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#yiwzuonmhu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yiwzuonmhu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#yiwzuonmhu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yiwzuonmhu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yiwzuonmhu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yiwzuonmhu .gt_left {\n  text-align: left;\n}\n\n#yiwzuonmhu .gt_center {\n  text-align: center;\n}\n\n#yiwzuonmhu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#yiwzuonmhu .gt_font_normal {\n  font-weight: normal;\n}\n\n#yiwzuonmhu .gt_font_bold {\n  font-weight: bold;\n}\n\n#yiwzuonmhu .gt_font_italic {\n  font-style: italic;\n}\n\n#yiwzuonmhu .gt_super {\n  font-size: 65%;\n}\n\n#yiwzuonmhu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#yiwzuonmhu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#yiwzuonmhu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#yiwzuonmhu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#yiwzuonmhu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#yiwzuonmhu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#yiwzuonmhu .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#yiwzuonmhu .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#yiwzuonmhu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Contrast\">Contrast</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Estimate\">Estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SE\">SE</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"t-ratio\">t ratio</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p-value\">p value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"6\" class=\"gt_group_heading\" style=\"text-align: center; font-weight: bold;\" scope=\"colgroup\" id=\"Treatment\">Treatment</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"Treatment  Contrast\" class=\"gt_row gt_center\">Control - High Graze</td>\n<td headers=\"Treatment  Estimate\" class=\"gt_row gt_right\">−4.83</td>\n<td headers=\"Treatment  SE\" class=\"gt_row gt_right\">2.42</td>\n<td headers=\"Treatment  df\" class=\"gt_row gt_right\">132</td>\n<td headers=\"Treatment  t ratio\" class=\"gt_row gt_right\">−2.00</td>\n<td headers=\"Treatment  p value\" class=\"gt_row gt_right\">0.072</td></tr>\n    <tr><td headers=\"Treatment  Contrast\" class=\"gt_row gt_center\">Control - Mow</td>\n<td headers=\"Treatment  Estimate\" class=\"gt_row gt_right\">−8.52</td>\n<td headers=\"Treatment  SE\" class=\"gt_row gt_right\">2.42</td>\n<td headers=\"Treatment  df\" class=\"gt_row gt_right\">132</td>\n<td headers=\"Treatment  t ratio\" class=\"gt_row gt_right\">−3.52</td>\n<td headers=\"Treatment  p value\" class=\"gt_row gt_right\">0.002</td></tr>\n    <tr><td headers=\"Treatment  Contrast\" class=\"gt_row gt_center\">Control - Graze</td>\n<td headers=\"Treatment  Estimate\" class=\"gt_row gt_right\">2.47</td>\n<td headers=\"Treatment  SE\" class=\"gt_row gt_right\">2.40</td>\n<td headers=\"Treatment  df\" class=\"gt_row gt_right\">132</td>\n<td headers=\"Treatment  t ratio\" class=\"gt_row gt_right\">1.03</td>\n<td headers=\"Treatment  p value\" class=\"gt_row gt_right\">0.306</td></tr>\n    <tr><td headers=\"Treatment  Contrast\" class=\"gt_row gt_center\">High Graze - Mow</td>\n<td headers=\"Treatment  Estimate\" class=\"gt_row gt_right\">−3.69</td>\n<td headers=\"Treatment  SE\" class=\"gt_row gt_right\">2.43</td>\n<td headers=\"Treatment  df\" class=\"gt_row gt_right\">132</td>\n<td headers=\"Treatment  t ratio\" class=\"gt_row gt_right\">−1.51</td>\n<td headers=\"Treatment  p value\" class=\"gt_row gt_right\">0.159</td></tr>\n    <tr><td headers=\"Treatment  Contrast\" class=\"gt_row gt_center\">High Graze - Graze</td>\n<td headers=\"Treatment  Estimate\" class=\"gt_row gt_right\">7.30</td>\n<td headers=\"Treatment  SE\" class=\"gt_row gt_right\">2.42</td>\n<td headers=\"Treatment  df\" class=\"gt_row gt_right\">132</td>\n<td headers=\"Treatment  t ratio\" class=\"gt_row gt_right\">3.02</td>\n<td headers=\"Treatment  p value\" class=\"gt_row gt_right\">0.006</td></tr>\n    <tr><td headers=\"Treatment  Contrast\" class=\"gt_row gt_center\">Mow - Graze</td>\n<td headers=\"Treatment  Estimate\" class=\"gt_row gt_right\">10.99</td>\n<td headers=\"Treatment  SE\" class=\"gt_row gt_right\">2.42</td>\n<td headers=\"Treatment  df\" class=\"gt_row gt_right\">132</td>\n<td headers=\"Treatment  t ratio\" class=\"gt_row gt_right\">4.55</td>\n<td headers=\"Treatment  p value\" class=\"gt_row gt_right\">&lt;0.001</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"6\" class=\"gt_group_heading\" style=\"text-align: center; font-weight: bold;\" scope=\"colgroup\" id=\"Location\">Location</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"Location  Contrast\" class=\"gt_row gt_center\">Lower - Middle</td>\n<td headers=\"Location  Estimate\" class=\"gt_row gt_right\">−7.94</td>\n<td headers=\"Location  SE\" class=\"gt_row gt_right\">2.43</td>\n<td headers=\"Location  df\" class=\"gt_row gt_right\">132</td>\n<td headers=\"Location  t ratio\" class=\"gt_row gt_right\">−3.26</td>\n<td headers=\"Location  p value\" class=\"gt_row gt_right\">0.002</td></tr>\n    <tr><td headers=\"Location  Contrast\" class=\"gt_row gt_center\">Lower - Upper</td>\n<td headers=\"Location  Estimate\" class=\"gt_row gt_right\">−9.82</td>\n<td headers=\"Location  SE\" class=\"gt_row gt_right\">2.57</td>\n<td headers=\"Location  df\" class=\"gt_row gt_right\">132</td>\n<td headers=\"Location  t ratio\" class=\"gt_row gt_right\">−3.83</td>\n<td headers=\"Location  p value\" class=\"gt_row gt_right\">&lt;0.001</td></tr>\n    <tr><td headers=\"Location  Contrast\" class=\"gt_row gt_center\">Middle - Upper</td>\n<td headers=\"Location  Estimate\" class=\"gt_row gt_right\">−1.87</td>\n<td headers=\"Location  SE\" class=\"gt_row gt_right\">2.11</td>\n<td headers=\"Location  df\" class=\"gt_row gt_right\">132</td>\n<td headers=\"Location  t ratio\" class=\"gt_row gt_right\">−0.89</td>\n<td headers=\"Location  p value\" class=\"gt_row gt_right\">0.377</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n### Summary\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nbiomass_diff %>%\n  filter(measure == \"p_total\") %>%\n  group_by(treatment) %>%\n  summarise(median = median(diff, na.rm =T),\n            mean = mean(diff, na.rm =T))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 3\n  treatment     median  mean\n  <chr>          <dbl> <dbl>\n1 Control         5.50 12.1 \n2 High Graze     10.4  16.3 \n3 Mow            18.7  19.5 \n4 Regular Graze   7.79  7.64\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nbiomass_diff %>%\n  filter(measure == \"p_total\") %>%\n  group_by(location) %>%\n  summarise(median = median(diff, na.rm =T),\n            mean = mean(diff, na.rm =T))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  location median  mean\n  <chr>     <dbl> <dbl>\n1 Lower     17.5  20.1 \n2 Middle     8.95 11.4 \n3 Upper      6.23  9.89\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n### Plotting\n\nOrdering of factors\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nplot_data <- biomass_diff %>% \n  mutate(treatment = fct_recode(treatment, \"Graze\" = \"Regular Graze\")) %>%\n  mutate(treatment = fct_relevel(treatment, c(\"Control\", \"Graze\", \"High Graze\", \"Mow\"))) %>%\n  mutate(location = fct_relevel(location, c(\"Upper\", \"Middle\", \"Lower\")))\n```\n:::\n\n\n\n\n\n\n\n\n\n\nExtra\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndf <- data.frame(x1 = c(-Inf, -Inf), x2 = c(Inf, Inf), y2 = c(Inf, 0), y1 = c(0, -Inf), difference = c(\"Net removal\", \"Net addition\")) %>%\n  mutate(difference = fct_relevel(difference, c(\"Net removal\", \"Net addition\"))) \n```\n:::\n\n\n\n\n\n\n\n\n\n\n\nPlots\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\np1 <- ggplot(data = filter(plot_data, measure == \"p_total\")) +\n  geom_rect(data = df, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2, fill = difference), alpha = 0.15) +\n  #geom_hline(yintercept = 0) +\n  scale_y_continuous(breaks = seq(-40, 120, 40)) +\n  geom_boxplot(data = filter(plot_data, measure == \"p_total\"), aes(x = treatment, y = diff)) +\n  theme_bw(base_size = 12) + \n  labs(y = expression(paste(\"Net WEP Difference (\", mg~m^{-2}, \")\")), x = \"Treatment\", tag = \"a)\") +\n  annotate(\"text\", x = \"Control\", y = 130, label = \"a\") + \n  annotate(\"text\", x = \"Graze\", y = 130, label = \"a\") + \n  annotate(\"text\", x = \"High Graze\", y = 130, label = \"b\") + \n  annotate(\"text\", x = \"Mow\", y = 130, label = \"b\") +\n  scale_fill_manual(values = c(\"white\", \"black\"), guide = guide_legend(override.aes = list(colour = \"black\"))) +\n  theme(axis.title.x = element_blank(),\n        axis.text.x = element_text(angle = 0, vjust = 1, hjust = 0.5))\np1\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](01_Biomass_analysis_files/figure-jats/unnamed-chunk-12-1.png)\n:::\n\n```{.r .cell-code .hidden}\np2 <- ggplot() +\n  geom_rect(data = df, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2, fill = difference), alpha = 0.15) +\n  geom_boxplot(data = filter(plot_data, measure == \"p_total\"), aes(x = location, y = diff)) +\n  theme_bw(base_size = 12) + \n  scale_y_continuous(breaks = seq(-40, 120, 40)) +\n  labs(tag = \"b)\") +\n  annotate(\"text\", x = \"Upper\", y = 130, label = \"a\") + \n  annotate(\"text\", x = \"Middle\", y = 130, label = \"ab\") + \n  annotate(\"text\", x = \"Lower\", y = 130, label = \"c\") +\n  scale_fill_manual(values = c(\"white\", \"black\"), guide = guide_legend(override.aes = list(colour = \"black\"))) +\n  theme(axis.title.y = element_blank(),\n        axis.title.x = element_blank(),\n        axis.text.x = element_text(angle = 0, vjust = 1, hjust = 0.5))\np2\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](01_Biomass_analysis_files/figure-jats/unnamed-chunk-12-2.png)\n:::\n:::\n\n::: {#cell-fig-vegetation-WEP .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-vegetation-WEP\n#| fig-cap: \"Change in riparian biomass WEP following grazing or mowing in each riparian location. Within each plot significant differences (p<0.05) between treatments or riparian locations are denoted with different letters. Lower sampling locations are adjacent to the edge of the waterbody and Upper locations are adjacent to the field.\"\n#| fig-alt: \"Boxplots showing the change in riparian biomass WEP following grazing or mowing.\"\n#|   \np3 <- p1 + p2 + plot_layout(guides = 'collect') & theme(legend.position = 'bottom', legend.title = element_blank())\np3\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\nRemoved 2 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: fig-vegetation-WEP\n#| fig-cap: \"Change in riparian biomass WEP following grazing or mowing in each riparian location. Within each plot significant differences (p<0.05) between treatments or riparian locations are denoted with different letters. Lower sampling locations are adjacent to the edge of the waterbody and Upper locations are adjacent to the field.\"\n#| fig-alt: \"Boxplots showing the change in riparian biomass WEP following grazing or mowing.\"\n#|   \n# ggsave(plot = p3, filename = here::here(\"./Figures/Figure 3.tiff\"), width = 174, height = 85, units = \"mm\", dpi = 400)\n```\n\n::: {.cell-output-display}\n![Change in riparian biomass WEP following grazing or mowing in each riparian location. Within each plot significant differences (p<0.05) between treatments or riparian locations are denoted with different letters. Lower sampling locations are adjacent to the edge of the waterbody and Upper locations are adjacent to the field.](01_Biomass_analysis_files/figure-jats/fig-vegetation-WEP-1.png){#fig-vegetation-WEP fig-alt='Boxplots showing the change in riparian biomass WEP following grazing or mowing.'}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n## Dry Weight\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nm2 <- glmmTMB((diff) ~ treatment * location + Before + (1|site) + (1|year),\n              data = filter(biomass_diff, measure == \"dryweight\"))\nsimulateResiduals(m2, n = 1000, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](01_Biomass_analysis_files/figure-jats/unnamed-chunk-14-1.png)\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nObject of Class DHARMa with simulated residuals based on 1000 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. \n \nScaled residual values: 0.854 0.648 0.326 0.646 0.318 0.725 0.668 0.466 0.81 0.586 0.427 0.882 0.777 0.897 0.805 0.368 0.704 0.594 0.586 0.522 ...\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncar::Anova(m2, type = \"III\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type III Wald chisquare tests)\n\nResponse: (diff)\n                    Chisq Df Pr(>Chisq)    \n(Intercept)        26.264  1  2.978e-07 ***\ntreatment          14.420  3   0.002385 ** \nlocation           10.771  2   0.004581 ** \nBefore             76.432  1  < 2.2e-16 ***\ntreatment:location 13.564  6   0.034909 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nperformance::check_collinearity(glmmTMB((diff) ~ treatment + location + Before + (1|site) + (1|year),\n                                        data = filter(biomass_diff, measure == \"dryweight\")))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Check for Multicollinearity\n\nLow Correlation\n\n      Term  VIF   VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n treatment 1.04 [1.00, 2.88]         1.02      0.96     [0.35, 1.00]\n  location 1.77 [1.47, 2.27]         1.33      0.57     [0.44, 0.68]\n    Before 1.81 [1.50, 2.32]         1.35      0.55     [0.43, 0.67]\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\nPost-hoc\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nm_emms2 <- emmeans(m2, ~treatment * location)\nemmeans(m2, pairwise ~ location|treatment, adjust = \"fdr\")$contrasts\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntreatment = Control:\n contrast       estimate     SE  df t.ratio p.value\n Lower - Middle -0.03993 0.0395 128  -1.011  0.3138\n Lower - Upper  -0.12232 0.0389 128  -3.147  0.0062\n Middle - Upper -0.08239 0.0365 128  -2.257  0.0386\n\ntreatment = High Graze:\n contrast       estimate     SE  df t.ratio p.value\n Lower - Middle -0.12667 0.0382 128  -3.315  0.0018\n Lower - Upper  -0.14328 0.0383 128  -3.744  0.0008\n Middle - Upper -0.01661 0.0365 128  -0.456  0.6495\n\ntreatment = Mow:\n contrast       estimate     SE  df t.ratio p.value\n Lower - Middle -0.02560 0.0372 128  -0.689  0.7859\n Lower - Upper  -0.01067 0.0392 128  -0.272  0.7859\n Middle - Upper  0.01493 0.0372 128   0.401  0.7859\n\ntreatment = Regular Graze:\n contrast       estimate     SE  df t.ratio p.value\n Lower - Middle  0.00666 0.0411 128   0.162  0.8716\n Lower - Upper  -0.02837 0.0430 128  -0.660  0.7658\n Middle - Upper -0.03503 0.0367 128  -0.955  0.7658\n\nNote: contrasts are still on the ( scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nP value adjustment: fdr method for 3 tests \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nemmeans(m2, pairwise ~ treatment|location, adjust = \"fdr\")$contrasts\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nlocation = Lower:\n contrast                   estimate     SE  df t.ratio p.value\n Control - High Graze        -0.0674 0.0368 128  -1.829  0.1046\n Control - Mow               -0.1391 0.0368 128  -3.778  0.0014\n Control - Regular Graze     -0.0532 0.0368 128  -1.446  0.1808\n High Graze - Mow            -0.0717 0.0365 128  -1.966  0.1029\n High Graze - Regular Graze   0.0142 0.0378 128   0.375  0.7081\n Mow - Regular Graze          0.0859 0.0378 128   2.274  0.0740\n\nlocation = Middle:\n contrast                   estimate     SE  df t.ratio p.value\n Control - High Graze        -0.1541 0.0365 128  -4.222  0.0003\n Control - Mow               -0.1248 0.0366 128  -3.410  0.0017\n Control - Regular Graze     -0.0066 0.0365 128  -0.181  0.8567\n High Graze - Mow             0.0294 0.0367 128   0.799  0.5107\n High Graze - Regular Graze   0.1475 0.0366 128   4.036  0.0003\n Mow - Regular Graze          0.1182 0.0365 128   3.235  0.0023\n\nlocation = Upper:\n contrast                   estimate     SE  df t.ratio p.value\n Control - High Graze        -0.0883 0.0366 128  -2.412  0.0518\n Control - Mow               -0.0274 0.0370 128  -0.743  0.4591\n Control - Regular Graze      0.0408 0.0367 128   1.109  0.3234\n High Graze - Mow             0.0609 0.0366 128   1.665  0.1474\n High Graze - Regular Graze   0.1291 0.0365 128   3.538  0.0034\n Mow - Regular Graze          0.0682 0.0365 128   1.868  0.1280\n\nNote: contrasts are still on the ( scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nP value adjustment: fdr method for 6 tests \n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n### Plots\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nggplot(data = filter(plot_data, measure == \"dryweight\"), aes(x = treatment, y = diff, fill = location)) +\n  geom_boxplot() +\n  labs(y = \"kg/m^2\") +\n  geom_hline(yintercept = 0) +\n  facet_grid(~measure) \n```\n\n::: {.cell-output-display}\n![](01_Biomass_analysis_files/figure-jats/unnamed-chunk-16-1.png)\n:::\n\n```{.r .cell-code .hidden}\nggplot(data = filter(plot_data, measure == \"dryweight\"), aes(x = treatment, y = diff, fill = location)) +\n  geom_boxplot() +\n  labs(y = \"kg/m^2\") +\n  geom_hline(yintercept = 0) +\n  facet_grid(location~measure) \n```\n\n::: {.cell-output-display}\n![](01_Biomass_analysis_files/figure-jats/unnamed-chunk-16-2.png)\n:::\n\n```{.r .cell-code .hidden}\nggplot(data = filter(plot_data, measure == \"dryweight\"), aes(x = location, y = diff, fill = treatment)) +\n  geom_boxplot() +\n  labs(y = \"kg/m^2\") +\n  geom_hline(yintercept = 0) +\n  facet_grid(treatment~measure) \n```\n\n::: {.cell-output-display}\n![](01_Biomass_analysis_files/figure-jats/unnamed-chunk-16-3.png)\n:::\n:::\n",
    "supporting": [
      "01_Biomass_analysis_files/figure-jats"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}